<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE composition PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
                template="./../../template/newTemplate.xhtml"
                xmlns:h="http://xmlns.jcp.org/jsf/html"
                xmlns:p="http://primefaces.org/ui"

                xmlns:f="http://xmlns.jcp.org/jsf/core"
                xmlns="http://www.w3.org/1999/xhtml"
                xmlns:c="http://xmlns.jcp.org/jsp/jstl/core">
    <ui:define name="content">

        <f:event listener="#{userData.authorize}" type="preRenderView" />


        <div class="col-xs-12">
            <p:messages autoUpdate="true"  showDetail="true" closable="true" rendered="true" />
        </div>




        <h:form id="form"  dir="#{userData.dir}"  style="margin-right: 20px">

            <div style=" position: absolute;left: 20px"> 

                <p:commandButton  style="width: 90px;background-image: none!important;z-index: 2" 
                                  class="viewButton searchButton"
                                  value="Hide/Show"/>  
            </div>

            <p:fieldset  style=" position: relative" legend="#{userData.userDDs['INV_STORES_REP']}"> 

                <div class="ui-g firstset" id="firstSegment ">

                    <div class="ui-g-12 ui-md-6">

                        <h:panelGroup>
                            <h:panelGroup>
                                <p:outputLabel  style="width: 50px" value="#{userData.userDDs['UNTIL_DATE']}"/>
                            </h:panelGroup>

                            <h:panelGroup>
                                <p:calendar pattern="dd/MM/yyyy" 
                                            id="dateTo"
                                            value="#{InventoryStripReportMB.invStripSearchBean.dateTo}"
                                            style="width: 56%">
                                </p:calendar>
                            </h:panelGroup>
                        </h:panelGroup>

                    </div>

                    <div class="ui-g-12 ui-md-6">

                        <h:panelGroup></h:panelGroup>

                    </div>

                    <div class="ui-g-12 ui-md-6">



                        <h:panelGroup>
                            <h:panelGroup>
                                <p:outputLabel style="width: 50px" value="#{userData.userDDs['FROM_REPOS']}"/>
                            </h:panelGroup> 

                            <h:panelGroup>
                                <p:autoComplete style="width:75%!important " 
                                                dropdown="true"
                                                converter="#{InventoryStripReportMB.invInventoryConverter}"
                                                value="#{InventoryStripReportMB.invStripSearchBean.inventoryFrom}"
                                                var="inventory"
                                                itemLabel="#{inventory}" 
                                                itemValue="#{inventory}" 
                                                forceSelection="true" 
                                                completeMethod="#{InventoryStripReportMB.completInventory}" >
                                </p:autoComplete>
                            </h:panelGroup> 
                        </h:panelGroup>

                    </div>

                    <div class="ui-g-12 ui-md-6">


                        <h:panelGroup>
                            <h:panelGroup>
                                <p:outputLabel style="width: 50px" value="#{userData.userDDs['TO_REPOS']}"/>
                            </h:panelGroup> 

                            <h:panelGroup>
                                <p:autoComplete style="width:75%!important " 
                                                dropdown="true"
                                                converter="#{InventoryStripReportMB.invInventoryConverter}"
                                                value="#{InventoryStripReportMB.invStripSearchBean.inventoryTo}"
                                                var="inventory"
                                                itemLabel="#{inventory}" 
                                                itemValue="#{inventory}" 
                                                forceSelection="true" 
                                                completeMethod="#{InventoryStripReportMB.completInventory}" >
                                </p:autoComplete>
                            </h:panelGroup> 
                        </h:panelGroup>


                    </div>


                    <div class="ui-g-12 ui-md-6">

                        <h:panelGroup>
                            <h:panelGroup>
                                <p:outputLabel style="width: 50px" value="#{userData.userDDs['FROM_GROUP']}"/>
                            </h:panelGroup> 

                            <h:panelGroup>
                                <p:autoComplete style="width:75%!important " 
                                                dropdown="true"
                                                converter="#{InventoryStripReportMB.groupConverter}"
                                                value="#{InventoryStripReportMB.invStripSearchBean.groupFrom}"
                                                var="group"
                                                itemLabel="#{group}" 
                                                itemValue="#{group}" 
                                                forceSelection="true" 
                                                completeMethod="#{InventoryStripReportMB.completInvGroups}" >
                                </p:autoComplete>
                            </h:panelGroup> 
                        </h:panelGroup>

                    </div>

                    <div class="ui-g-12 ui-md-6">

                        <h:panelGroup>
                            <h:panelGroup>
                                <p:outputLabel style="width: 50px" value="#{userData.userDDs['TO_GROUP']}"/>
                            </h:panelGroup> 

                            <h:panelGroup>
                                <p:autoComplete style="width:75%!important " 
                                                dropdown="true"
                                                converter="#{InventoryStripReportMB.groupConverter}"
                                                value="#{InventoryStripReportMB.invStripSearchBean.groupTo}"
                                                var="group"
                                                itemLabel="#{group}" 
                                                itemValue="#{group}" 
                                                forceSelection="true" 
                                                completeMethod="#{InventoryStripReportMB.completInvGroups}" >
                                </p:autoComplete>

                            </h:panelGroup> 
                        </h:panelGroup>

                    </div>

                    <div class="ui-g-12 ui-md-6">

                        <h:panelGroup>
                            <h:panelGroup>
                                <p:outputLabel style="width: 50px" value="#{userData.userDDs['FROM_SUPPLIER']}"/>
                            </h:panelGroup> 

                            <h:panelGroup>
                                <p:autoComplete style="width:75%!important " 
                                                dropdown="true"
                                                converter="#{InventoryStripReportMB.suplierConverter}"
                                                value="#{InventoryStripReportMB.invStripSearchBean.suplierFrom}"
                                                var="suplier"
                                                itemLabel="#{suplier}" 
                                                itemValue="#{suplier}" 
                                                forceSelection="true" 
                                                completeMethod="#{InventoryStripReportMB.completSupliers}" >
                                </p:autoComplete>
                            </h:panelGroup> 
                        </h:panelGroup>

                    </div>

                    <div class="ui-g-12 ui-md-6">


                        <h:panelGroup>
                            <h:panelGroup>
                                <p:outputLabel style="width: 50px" value="#{userData.userDDs['TO_SUPPLIER']}"/>
                            </h:panelGroup> 

                            <h:panelGroup>
                                <p:autoComplete style="width:75%!important " 
                                                dropdown="true"
                                                converter="#{InventoryStripReportMB.suplierConverter}"
                                                value="#{InventoryStripReportMB.invStripSearchBean.suplierTo}"
                                                var="suplier"
                                                itemLabel="#{suplier}" 
                                                itemValue="#{suplier}" 
                                                forceSelection="true" 
                                                completeMethod="#{InventoryStripReportMB.completSupliers}" >
                                </p:autoComplete>
                            </h:panelGroup> 
                        </h:panelGroup>

                    </div>


                </div>




                <h:panelGrid class="col-md-12" columns="1">

                    <h:panelGroup  class="centerButtons"  style="margin-top: 2%">


                        <p:commandButton     class="searchButton"

                                             title="#{userData.userDDs['SEARCH']}"
                                             action="#{InventoryStripReportMB.search()}"
                                             id="search"
                                             value="#{userData.userDDs['SEARCH']}"
                                             update="invStripTable" 
                                             icon="fa fa-search"  />

                        <p:commandButton    class="newButton"
                                            id="NewB"
                                            title="#{userData.userDDs['NEW']}" 
                                            immediate="true" 
                                            action="#{InventoryStripReportMB.reset()}"
                                            update="@form"
                                            value="#{userData.userDDs['NEW']}"
                                            icon="fa fa-plus"/>

                        <p:commandButton     class="printButton"
                                             id="PrintB"
                                             ajax="false"
                                             onclick="form.target = '_blank'"  
                                             icon="fa fa-fw fa-print"
                                             value="#{userData.userDDs['PRINT']}" 
                                             actionListener="#{InventoryStripReportMB.exportPDF}"
                                             title="#{userData.userDDs['PRINT']}"
                                             immediate="true" />

                        <p:commandButton     class="closeButton"
                                             id="CloseB"
                                             icon="fa fa-fw fa-close"  
                                             title="#{userData.userDDs['BACK']}"
                                             action="exit"
                                             value="#{userData.userDDs['BACK']}"/>
                        <h:commandLink  class="sdcreenimg">  
                            <p:graphicImage name="/img/excel.jpg" width="24"/>  
                            <p:dataExporter type="xls"
                                            target="invStripTable" 
                                            fileName=" جرد المستودع"
                                            postProcessor="#{InventoryStripReportMB.postProcessXLS}" />  
                        </h:commandLink>

                        <p:blockUI block="form" trigger="search NewB PrintB CloseB" animate="true" >

                            <p:graphicImage library="img" name="9wcA.gif" ></p:graphicImage>

                        </p:blockUI> 


                    </h:panelGroup>

                </h:panelGrid>

            </p:fieldset>

            <p:fieldset  style="margin-top: 2%">

                <p:dataTable id="invStripTable"  paginator="true" rows="15"
                             var="invStripTable"
                             widgetVar="invStripTable" 
                             dir="rtl" 
                             emptyMessage="#{userData.userDDs['EMPTY_TABLE']}"
                             rowKey="#{invStripTable}"
                             value="#{InventoryStripReportMB.stripReportViewBeanList}"
                             rowIndexVar="index" 
                             rowStyleClass="#{(invStripTable.itemCode eq null) ? 'colored' : null} ">

                    <f:facet name="header">


                        <p:outputPanel>
                            <h:outputText value="#{userData.userDDs['SEARCH']} : "  style="font-size: large" />
                            <p:inputText id="globalFilter" onkeyup="PF('invStripTable').filter()" style="width:150px" />
                        </p:outputPanel>

                    </f:facet>

                    <p:columnGroup type="header">
                        <p:row>
                            <p:column rowspan="2"
                                      headerText="#{userData.userDDs['GROUP_NAME']}" 
                                      style="width: 10vh;font-size: 1.7vh;text-align: center"

                                      filterBy="#{invStripTable.groupName}" 
                                      filterMatchMode="contains" 
                                      sortBy="#{invStripTable.groupName}"
                                      filterable="false">
                            </p:column>

                            <p:column rowspan="2"
                                      headerText="#{userData.userDDs['ITEM_NUMBER']}" 
                                      style="width: 10vh;font-size: 1.7vh;text-align: center"

                                      filterBy="#{invStripTable.itemCode}" 
                                      filterMatchMode="contains" 
                                      sortBy="#{invStripTable.itemCode}"
                                      filterable="false">
                            </p:column>

                            <p:column rowspan="2"
                                      headerText="#{userData.userDDs['ITEM_NAME']}" 
                                      style="width: 15vh;font-size: 1.4vh;text-align: center"

                                      filterBy="#{invStripTable.itemName}" 
                                      filterMatchMode="contains" 
                                      sortBy="#{invStripTable.itemName}"
                                      filterable="false">
                            </p:column>

                            <p:column rowspan="2"
                                      headerText="#{userData.userDDs['UNIT']}" 
                                      style="width: 7vh;font-size: 1.4vh;text-align: center"

                                      filterBy="#{invStripTable.unitName}" 
                                      filterMatchMode="contains" 
                                      sortBy="#{invStripTable.unitName}"
                                      filterable="false">

                            </p:column>



                            <p:column colspan="2" headerText="#{userData.userDDs['TOT_REPOS_TRANS']}" 
                                      style="width: 20vh;font-size: 1.4vh;text-align: center"/>
                            <p:column rowspan="2" headerText="#{userData.userDDs['BALAN_AMOUNT']}" 
                                      style="width: 20vh;font-size: 1.4vh;text-align: center"

                                      filterBy="#{invStripTable.balance}" 
                                      filterMatchMode="contains" 
                                      sortBy="#{invStripTable.balance}"
                                      filterable="false"/>

                            <p:column rowspan="2" headerText="#{userData.userDDs['COST']}" 
                                      style="width: 8vh;font-size: 1.4vh;text-align: center"

                                      filterBy="#{invStripTable.costAverage}" 
                                      filterMatchMode="contains" 
                                      sortBy="#{invStripTable.costAverage}"
                                      filterable="false"/>

                            <p:column rowspan="2" headerText="#{userData.userDDs['TOTAL']}"  
                                      style="width: 12vh;font-size: 1.4vh;text-align: center"

                                      filterBy="#{invStripTable.balanceValue}" 
                                      filterMatchMode="contains" 
                                      sortBy="#{invStripTable.balanceValue}"
                                      filterable="false"/>


                        </p:row>
                        <p:row>
                            <p:column headerText="#{userData.userDDs['IMPORT']}" style="font-size: 1.4vh;text-align: center"

                                      filterBy="#{invStripTable.qtyIn}" 
                                      filterMatchMode="contains" 
                                      sortBy="#{invStripTable.qtyIn}"
                                      filterable="false"/>

                            <p:column headerText="#{userData.userDDs['EXPORT']}" style="font-size: 1.4vh;text-align: center"

                                      filterBy="#{invStripTable.qtyOut}" 
                                      filterMatchMode="contains" 
                                      sortBy="#{invStripTable.qtyOut}"
                                      filterable="false"/>

                        </p:row>
                    </p:columnGroup>

                    <p:column  style="width:10vh;font-size: 1.4vh;text-align: center" >
                        <h:outputText value="#{invStripTable.groupName}" style="font-size: 1.4vh"/>
                    </p:column>

                    <p:column  style="width:10vh;font-size: 1.4vh;text-align: center" >
                        <h:outputText value="#{invStripTable.itemCode}" style="font-size: 1.4vh"/>
                    </p:column>

                    <p:column   style="width:15vh;font-size: 1.4vh;text-align: center" >
                        <h:outputText value="#{invStripTable.itemName}" style="font-size: 1.4vh"/>
                    </p:column>    
                    <p:column  style="width:6vh;font-size: 1.4vh;text-align: center" >
                        <h:outputText value="#{invStripTable.unitName}" style="font-size: 1.4vh;width: 95%"/>
                    </p:column>

                    <p:column  style="width:8vh;font-size: 1.4vh;text-align: center" >
                        <p:inputNumber readonly="true" value="#{invStripTable.qtyIn}" style="font-size: 1.4vh;width: 90%"/>
                    </p:column>
                    <p:column  style="width:8vh;font-size: 1.4vh;text-align: center">
                        <p:inputNumber readonly="true" value="#{invStripTable.qtyOut}" style="font-size: 1.4vh;width: 95%"/>
                    </p:column>
                    <p:column  style="width:8vh;font-size: 1.4vh;text-align: center">
                        <p:inputNumber readonly="true" value="#{invStripTable.balance}" style="font-size: 1.4vh;width: 95%;"/>
                    </p:column>
                    <p:column  style="width:8vh;font-size: 1.4vh;text-align: center" >
                        <p:inputNumber readonly="true" value="#{invStripTable.costAverage}" style="font-size: 1.4vh;width: 95%"/>
                    </p:column>
                    <p:column  style="width:10vh;font-size: 1.4vh;text-align: center"  >
                        <p:inputNumber readonly="true" value="#{invStripTable.balanceValue}" style="font-size: 1.4vh;width: 95%"/>
                    </p:column>
                    <p:columnGroup type="footer">
                        <p:row>
                            <p:column  colspan="4" footerText="#{userData.userDDs['TOTAL']} " />
                            <p:column   footerText="#{InventoryStripReportMB.debitValue}" style="font-size: 1.2vh !important"/>
                            <p:column   footerText="#{InventoryStripReportMB.creditValue}"  style="font-size: 1.2vh !important"/>
                            <p:column   footerText="#{InventoryStripReportMB.balanceValue}" style="font-size: 1.2vh !important" />
                            <p:column   footerText="#{InventoryStripReportMB.firstValue}" style="font-size: 1.2vh !important" />
                            <p:column   footerText="#{InventoryStripReportMB.secondValue}" style="font-size: 1.2vh !important"/>

                        </p:row>
                    </p:columnGroup>

                </p:dataTable>
            </p:fieldset>
        </h:form>
    </ui:define>
</ui:composition>
