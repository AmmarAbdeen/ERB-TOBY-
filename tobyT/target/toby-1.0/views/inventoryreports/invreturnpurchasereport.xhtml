<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE composition PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
                template="./../../template/newTemplate.xhtml"
                xmlns:h="http://xmlns.jcp.org/jsf/html"
                xmlns:p="http://primefaces.org/ui"
                xmlns:f="http://xmlns.jcp.org/jsf/core"
                xmlns="http://www.w3.org/1999/xhtml"
                xmlns:c="http://xmlns.jcp.org/jsp/jstl/core">
    <ui:define name="content">
        <f:event listener="#{userData.authorize}" type="preRenderView" />
        
         <div style=" position: absolute;left: 20px"> 

                <p:commandButton  style="width: 90px;background-image: none!important;z-index: 2" 
                                  class="viewButton searchButton"
                                  value="Hide/Show"/>  
            </div>
		
        <h:form  id="form" dir="#{userData.dir}"  style="margin-right: 20px">
           
            <p:fieldset  legend=" #{userData.userDDs['PROCUR_RET_REP']}"
                         
                        style=" position: relative">
			
                <div  id="firstSegment" class="ui-g-12 ui-g-nopad firstset">
                    <div class="ui-g">

                        <div class="ui-g-12 ui-md-6">
                            <h:panelGroup>
                                <h:panelGroup>
                                    <p:outputLabel style="width: 70px" value="#{userData.userDDs['FROM_SUPPLIER']}"/>
                                </h:panelGroup> 

                                <h:panelGroup>
                                    <p:autoComplete style="width:75%!important " 
                                                    dropdown="true"
                                                    converter="#{InvReturnPurchaseReportMB.suplierConverter}"
                                                    value="#{InvReturnPurchaseReportMB.invReturnPurchaseSearchBean.suplierFrom}"
                                                    var="suplier"
                                                    itemLabel="#{suplier}" 
                                                    itemValue="#{suplier}" 
                                                    forceSelection="true" 
                                                    completeMethod="#{InvReturnPurchaseReportMB.completSupliers}" >
                                    </p:autoComplete>
                                </h:panelGroup> 
                            </h:panelGroup>
                        </div>
                        <div class="ui-g-12 ui-md-6">
                            <h:panelGroup>
                                <h:panelGroup>
                                    <p:outputLabel style="width: 70px" value="#{userData.userDDs['TO_SUPPLIER']}"/>
                                </h:panelGroup> 

                                <h:panelGroup>
                                    <p:autoComplete style="width:75%!important " 
                                                    dropdown="true"
                                                    converter="#{InvReturnPurchaseReportMB.suplierConverter}"
                                                    value="#{InvReturnPurchaseReportMB.invReturnPurchaseSearchBean.suplierTo}"
                                                    var="suplier"
                                                    itemLabel="#{suplier}" 
                                                    itemValue="#{suplier}" 
                                                    forceSelection="true" 
                                                    completeMethod="#{InvReturnPurchaseReportMB.completSupliers}" >
                                    </p:autoComplete>
                                </h:panelGroup> 
                            </h:panelGroup>

                        </div>
                        <div class="ui-g-12 ui-md-6">
                            <h:panelGroup>
                                <h:panelGroup>
                                    <p:outputLabel  style="width: 70px" value="#{userData.userDDs['FROM_DATE']}"/>
                                </h:panelGroup>

                                <h:panelGroup>
                                    <p:calendar pattern="dd/MM/yyyy" 
                                                value="#{InvReturnPurchaseReportMB.invReturnPurchaseSearchBean.dateFrom}"
                                                style="width: 56%">

                                    </p:calendar>
                                </h:panelGroup>
                            </h:panelGroup>
                        </div>
                        <div class="ui-g-12 ui-md-6">
                            <h:panelGroup>
                                <h:panelGroup>
                                    <p:outputLabel  style="width: 70px" value="#{userData.userDDs['TO_DATE']}"/>
                                </h:panelGroup>

                                <h:panelGroup>
                                    <p:calendar pattern="dd/MM/yyyy" 
                                                value="#{InvReturnPurchaseReportMB.invReturnPurchaseSearchBean.dateTo}"
                                                style="width: 56%">

                                    </p:calendar>
                                </h:panelGroup>
                            </h:panelGroup>

                        </div>
                        <div class="ui-g-12 ui-md-6">
                            <h:panelGroup>
                                <h:panelGroup>
                                    <p:outputLabel style="width: 70px" value="#{userData.userDDs['FROM_REPOS_NO']}"/>
                                </h:panelGroup> 

                                <h:panelGroup>
                                    <p:autoComplete style="width:75%!important " 
                                                    dropdown="true"
                                                    converter="#{InvReturnPurchaseReportMB.invInventoryConverter}"
                                                    value="#{InvReturnPurchaseReportMB.invReturnPurchaseSearchBean.inventoryFrom}"
                                                    var="inventory"
                                                    itemLabel="#{inventory}" 
                                                    itemValue="#{inventory}" 
                                                    forceSelection="true" 
                                                    completeMethod="#{InvReturnPurchaseReportMB.completInventory}" >
                                    </p:autoComplete>
                                </h:panelGroup> 
                            </h:panelGroup>
                        </div>
                        <div class="ui-g-12 ui-md-6">
                            <h:panelGroup>
                                <h:panelGroup>
                                    <p:outputLabel style="width: 70px" value="#{userData.userDDs['TO_REPOS_NO']}"/>
                                </h:panelGroup> 

                                <h:panelGroup>
                                    <p:autoComplete style="width:75%!important " 
                                                    dropdown="true"
                                                    converter="#{InvReturnPurchaseReportMB.invInventoryConverter}"
                                                    value="#{InvReturnPurchaseReportMB.invReturnPurchaseSearchBean.inventoryTo}"
                                                    var="inventory"
                                                    itemLabel="#{inventory}" 
                                                    itemValue="#{inventory}" 
                                                    forceSelection="true" 
                                                    completeMethod="#{InvReturnPurchaseReportMB.completInventory}" >
                                    </p:autoComplete>
                                </h:panelGroup> 
                            </h:panelGroup>

                        </div>
                        <div class="ui-g-12 ui-md-6">
                            <h:panelGroup>
                                <h:panelGroup>
                                    <p:outputLabel style="width: 70px" value="#{userData.userDDs['FROM_RETU_NO']}"/>
                                </h:panelGroup> 

                                <h:panelGroup>
                                    <p:autoComplete id="purchaseIdFrom"
                                                    style="width:75%!important " 
                                                    dropdown="true"

                                                    converter="#{InvReturnPurchaseReportMB.invReturnPurchaseConverter}"
                                                    value="#{InvReturnPurchaseReportMB.invReturnPurchaseSearchBean.invReturnPurchaseFrom}"

                                                    var="purchasePerson"
                                                    itemLabel="#{purchasePerson}" 
                                                    itemValue="#{purchasePerson}" 
                                                    forceSelection="true" 
                                                    completeMethod="#{InvReturnPurchaseReportMB.completePurchaseReturn}">
                                    </p:autoComplete>
                                </h:panelGroup> 
                            </h:panelGroup>
                        </div>
                        <div class="ui-g-12 ui-md-6">
                            <h:panelGroup>
                                <h:panelGroup>
                                    <p:outputLabel style="width: 70px" value="#{userData.userDDs['TO_RETU_NO']}"/>
                                </h:panelGroup> 

                                <h:panelGroup>
                                    <p:autoComplete id="purchaseIdTo"
                                                    style="width:75%!important " 
                                                    dropdown="true"

                                                    converter="#{InvReturnPurchaseReportMB.invReturnPurchaseConverter}"
                                                    value="#{InvReturnPurchaseReportMB.invReturnPurchaseSearchBean.invReturnPurchaseTo}"

                                                    var="purchasePerson"
                                                    itemLabel="#{purchasePerson}" 
                                                    itemValue="#{purchasePerson}" 
                                                    forceSelection="true" 
                                                    completeMethod="#{InvReturnPurchaseReportMB.completePurchaseReturn}">
                                    </p:autoComplete>
                                </h:panelGroup> 
                            </h:panelGroup>
                        </div>
                        <div class="ui-g-12 ui-md-6">
                            <h:panelGroup>
                                <h:panelGroup>
                                    <p:outputLabel style="width: 70px" value="#{userData.userDDs['FROM_RETU_TYP']}"/>
                                </h:panelGroup> 

                                <h:panelGroup>
                                    <p:selectOneMenu style="width:56%!important "
                                                     id="invoiceTypeFrom" 
                                                     value ="#{InvReturnPurchaseReportMB.invReturnPurchaseSearchBean.paymentTypeFrom}">                                                             
                                        <f:selectItem itemLabel="#{userData.userDDs['CHOOSE']}"/>
                                        <f:selectItem itemLabel="#{userData.userDDs['CASH']}"  itemValue="0"  />                            
                                        <f:selectItem itemLabel="#{userData.userDDs['POSTPONE']}" itemValue="1" />
                                        <f:selectItem itemLabel="#{userData.userDDs['DECOM_CREDIT']}" itemValue="2" />
                                    </p:selectOneMenu>    
                                </h:panelGroup> 
                            </h:panelGroup>
                        </div>
                        <div class="ui-g-12 ui-md-6">
                            <h:panelGroup>
                                <h:panelGroup>
                                    <p:outputLabel style="width: 70px" value="#{userData.userDDs['TO_RETU_TYP']}"/>
                                </h:panelGroup> 

                                <h:panelGroup>
                                    <p:selectOneMenu style="width:56%!important " id="invoiceTypeTo" 
                                                     value ="#{InvReturnPurchaseReportMB.invReturnPurchaseSearchBean.paymentTypeTo}">    
                                        <f:selectItem itemLabel="#{userData.userDDs['CHOOSE']}"/>
                                        <f:selectItem itemLabel="#{userData.userDDs['CASH']}"  itemValue="0"  />                            
                                        <f:selectItem itemLabel="#{userData.userDDs['POSTPONE']}" itemValue="1" />
                                        <f:selectItem itemLabel="#{userData.userDDs['DECOM_CREDIT']} " itemValue="2" />
                                    </p:selectOneMenu>  
                                </h:panelGroup> 
                            </h:panelGroup>
                        </div>
                    </div>
                </div>


                <h:panelGrid  columns="1"  class="col-md-12" >

                    <h:panelGroup class="centerButtons" style="margin-top: 2%">


                        <p:commandButton    class="searchButton"
                                            title="#{userData.userDDs['SEARCH']}"
                                            action="#{InvReturnPurchaseReportMB.search()}"
                                            id="saveB"
                                            value="#{userData.userDDs['SEARCH']}"
                                            update="@form" 
                                            icon="fa fa-search"  />

                        <p:commandButton  class="newButton"
                                          title="#{userData.userDDs['NEW']}" 
                                          id="NewB"
                                          immediate="true" 
                                          action="#{InvReturnPurchaseReportMB.reset()}"
                                          update="form"
                                          value="#{userData.userDDs['NEW']}"
                                          icon="fa fa-plus"/>

                        <p:commandButton   class="printButton"
                                           id="PrintB"
                                           ajax="false"
                                           onclick="form.target = '_blank'"  
                                           icon="fa fa-fw fa-print"
                                           value="#{userData.userDDs['PRINT']}" 
                                           actionListener="#{InvReturnPurchaseReportMB.exportPDF}"
                                           title="#{userData.userDDs['PRINT']}"
                                           immediate="true" />

                        <p:commandButton   class="closeButton"
                                           id="CloseB"
                                           icon="fa fa-fw fa-backward"  
                                           value="#{userData.userDDs['BACK']}" 
                                           title="#{userData.userDDs['BACK']}"
                                           action="exit"
                                           />

                        <h:commandLink class="sdcreenimg">  
                            <p:graphicImage name="/img/excel.jpg" width="24"/>  
                            <p:dataExporter type="xls"
                                            target="returnInvoiceViewTable" 
                                            fileName=" تقرير مردودات المشتريات"
                                            postProcessor="#{InvReturnPurchaseReportMB.postProcessXLS}" />  
                        </h:commandLink>

                        <p:blockUI block="form" trigger="saveB NewB PrintB CloseB" animate="true" >

                            <p:graphicImage library="img" name="9wcA.gif" ></p:graphicImage>

                        </p:blockUI> 

                    </h:panelGroup>

                </h:panelGrid>
            </p:fieldset>

            <p:fieldset id="reportDB"  style="margin-top: 2%">
                <p:dataTable style="margin-top: 2%"
                             draggableColumns="true" 
                             var="returnInvoiceViewTable" 
                             widgetVar="returnInvoiceViewTable"  
                             rowKey="#{returnInvoiceViewTable}"
                             rowIndexVar="index" 
                             value="#{InvReturnPurchaseReportMB.returnInvoiceReportBeanList}" 
                             dir="rtl" 
                             paginator="true"
                              rows="20"
                             emptyMessage="#{userData.userDDs['EMPTY_TABLE']}"
                             id="returnInvoiceViewTable">

                    <f:facet name="header">


                        <p:outputPanel>
                            <h:outputText value="#{userData.userDDs['SEARCH']} : "  style="font-size: large" />
                            <p:inputText id="globalFilter" onkeyup="PF('returnInvoiceViewTable').filter()" style="width:150px" />
                        </p:outputPanel>

                    </f:facet>

                    <p:column   style="width: 8vh;text-align: center;font-size: 1.8vh" headerText="#{userData.userDDs['RETU_NO']}"

                                filterBy="#{returnInvoiceViewTable.serial}" 
                                filterMatchMode="contains" 
                                sortBy="#{returnInvoiceViewTable.serial}"
                                filterable="false">
                        <p:outputLabel value="#{returnInvoiceViewTable.serial}" />
                    </p:column>

                    <p:column style="width: 12vh;text-align: center;font-size: 1.8vh" filterStyle="display:none"
                              headerText="#{userData.userDDs['PURCH_INVO_NO']}" 

                              filterBy="#{returnInvoiceViewTable.invoiceSerial}" 
                              filterMatchMode="contains" 
                              sortBy="#{returnInvoiceViewTable.invoiceSerial}"
                              filterable="false">
                        <p:outputLabel value="#{returnInvoiceViewTable.invoiceSerial}" />
                    </p:column>

                    <p:column style="width: 12vh;text-align: center;font-size: 1.8vh" 
                              headerText="#{userData.userDDs['DATEE']}"

                              filterBy="#{returnInvoiceViewTable.date}" 
                              filterMatchMode="contains" 
                              sortBy="#{returnInvoiceViewTable.date}"
                              filterable="false">

                        <p:outputLabel value="#{returnInvoiceViewTable.date}">
                            <f:convertDateTime type="date" pattern="dd-MM-yyyy"/>
                        </p:outputLabel>
                    </p:column>


                    <p:column style="width: 10vh;text-align:center;font-size: 1.8vh" 
                              headerText="#{userData.userDDs['SUPPLIER']}"

                              filterBy="#{returnInvoiceViewTable.supplierCode} #{returnInvoiceViewTable.supplierName}" 
                              filterMatchMode="contains" 
                              sortBy="#{returnInvoiceViewTable.supplierCode} #{returnInvoiceViewTable.supplierName}"
                              filterable="false">

                        <p:outputLabel value="#{returnInvoiceViewTable.supplierCode} #{returnInvoiceViewTable.supplierName}" >

                        </p:outputLabel>
                    </p:column>  
                    <p:column style="width: 10vh;text-align:center;font-size: 1.8vh" 
                              headerText="#{userData.userDDs['RETURN']}"

                              filterBy="#{returnInvoiceViewTable.net}" 
                              filterMatchMode="contains" 
                              sortBy="#{returnInvoiceViewTable.net}"
                              filterable="false">

                        <p:outputLabel value="#{returnInvoiceViewTable.net}" >
                        </p:outputLabel>                           
                    </p:column>
                </p:dataTable>

            </p:fieldset>
        </h:form>
    </ui:define>
</ui:composition>
