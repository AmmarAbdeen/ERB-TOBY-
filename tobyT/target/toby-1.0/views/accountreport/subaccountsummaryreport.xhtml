<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE composition PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
                template="./../../template/newTemplate.xhtml"
                xmlns:p="http://primefaces.org/ui"
                xmlns:h="http://xmlns.jcp.org/jsf/html"
                xmlns:f="http://java.sun.com/jsf/core"
                xmlns:a="http://xmlns.jcp.org/jsf/passthrough"
                xmlns="http://www.w3.org/1999/xhtml">
    <link rel="stylesheet" type="text/css" href="../../resources/css/main.css" /> 
    <ui:define name="content">
        <div class="col-xs-12">
            <p:messages autoUpdate="true"  showDetail="true" closable="true" rendered="true" />
        </div>
        <f:event listener="#{userData.authorize}" type="preRenderView" />
        <h:head>
            <title>#{userData.userDDs['ACCOUNT_REPORT']}</title>
        </h:head>

        <style>

            .ui-widget-content .ui-state-default, .ui-widget-header .ui-state-default {
                border: 1px solid #c5dbec;
                background:#fff;
            }

        </style>

        <h:body> 
            <h:form id="form" style="margin-right: 20px">     

                <div style=" position: absolute;left: 20px"> 

                    <p:commandButton  style="width: 90px;background-image: none!important;z-index: 2" 
                                      class="viewButton searchButton"
                                      value="Hide/Show"/>  
                </div>

                <p:fieldset  id="TopFielSet" legend="#{userData.userDDs['STAT_SUBS_ACCOUNT']}"
                             style=" position: relative" >
                    <div class="firstset">
                        <div class="col-xs-12">
                            <p:messages autoUpdate="true" 
                                        id="msg" showDetail="true" closable="true" 
                                        rendered="#{subAccountSummaryReportMB.showMessageGeneral}"/>
                        </div>
                        <div class="ui-g-12 ui-g-nopad">
                            <div class="ui-g">

                                <div class="ui-g-12 ui-md-6">
                                    <h:panelGroup>
                                        <h:panelGroup>
                                            <p:outputLabel style="width: 65px" value="#{userData.userDDs['ACCOUNT_NAME']}" for="GlAccount_ID"/>
                                        </h:panelGroup>
                                        <h:panelGroup>
                                            <p:autoComplete style="width: 75%" id="GlAccount_ID" 

                                                            dropdown="true"
                                                            converter="#{subAccountSummaryReportMB.accountConverter}"
                                                            value="#{subAccountSummaryReportMB.glAccountSelected}"
                                                            var="p"
                                                            itemLabel="#{p}" 
                                                            itemValue="#{p}" 
                                                            forceSelection="false" 
                                                            completeMethod="#{subAccountSummaryReportMB.completeGlAccount}" >
                                            </p:autoComplete>
                                        </h:panelGroup>

                                    </h:panelGroup>
                                </div>
                                <div class="ui-g-12 ui-md-6">
                                    <h:panelGroup></h:panelGroup>
                                </div>
                                <div class="ui-g-12 ui-md-6">
                                    <h:panelGroup>
                                        <h:panelGroup> 
                                            <p:outputLabel style="width: 65px" value="#{userData.userDDs['FROM_COST_CENTER']}" for="Cost_Center_From"/>
                                        </h:panelGroup>

                                        <h:panelGroup>
                                            <p:autoComplete style="width:75%" id="Cost_Center_From" 
                                                            dropdown="true"
                                                            converter="#{subAccountSummaryReportMB.costCenterConverter}"
                                                            value="#{subAccountSummaryReportMB.costCenterFromSelected}"

                                                            var="cost"
                                                            itemLabel="#{cost}" 
                                                            itemValue="#{cost}" 
                                                            forceSelection="true" 
                                                            completeMethod="#{subAccountSummaryReportMB.completeCostCenter}" >
                                            </p:autoComplete>
                                        </h:panelGroup>
                                    </h:panelGroup>

                                </div>
                                <div class="ui-g-12 ui-md-6">

                                    <h:panelGroup> 

                                        <h:panelGroup>
                                            <p:outputLabel style="width: 65px" value="#{userData.userDDs['COST_CENTER_TO']}" for="COST_CENTER_TO"/>
                                        </h:panelGroup>
                                        <h:panelGroup>
                                            <p:autoComplete style="width:75%" id="COST_CENTER_TO" 
                                                            dropdown="true"
                                                            converter="#{subAccountSummaryReportMB.costCenterConverter}"
                                                            value="#{subAccountSummaryReportMB.costCenterToSelected}"

                                                            var="costt"
                                                            itemLabel="#{costt}" 
                                                            itemValue="#{costt}" 
                                                            forceSelection="true" 
                                                            completeMethod="#{subAccountSummaryReportMB.completeCostCenter}" >


                                            </p:autoComplete>

                                        </h:panelGroup>

                                    </h:panelGroup>
                                </div>
                                <div class="ui-g-12 ui-md-6">
                                    <h:panelGroup>
                                        <h:panelGroup>
                                            <p:outputLabel style="width: 65px" value="#{userData.userDDs['FROM_ADMIN_UNIT']}" for="ADMIN_UNIT_FROM"/>
                                        </h:panelGroup>
                                        <h:panelGroup>
                                            <p:autoComplete style="width:75%" id="ADMIN_UNIT_FROM" 
                                                            dropdown="true"
                                                            converter="#{subAccountSummaryReportMB.glAdminUnitConverter}"
                                                            value="#{subAccountSummaryReportMB.glAdminUnitFromSelected}"

                                                            var="admin"
                                                            itemLabel="#{admin}" 
                                                            itemValue="#{admin}" 
                                                            forceSelection="true" 
                                                            completeMethod="#{subAccountSummaryReportMB.completeAdminUnit}" >


                                            </p:autoComplete>
                                        </h:panelGroup>
                                    </h:panelGroup>
                                </div>
                                <div class="ui-g-12 ui-md-6">

                                    <h:panelGroup>
                                        <h:panelGroup>
                                            <p:outputLabel style="width: 65px" value="#{userData.userDDs['TO_ADMIN_UNIT']}" for="ADMIN_UNIT_TO"/>
                                        </h:panelGroup>
                                        <h:panelGroup>
                                            <p:autoComplete style="width:75%" id="ADMIN_UNIT_TO" 
                                                            dropdown="true"
                                                            converter="#{subAccountSummaryReportMB.glAdminUnitConverter}"
                                                            value="#{subAccountSummaryReportMB.glAdminUnitToSelected}"

                                                            var="adminn"
                                                            itemLabel="#{adminn}" 
                                                            itemValue="#{adminn}" 
                                                            forceSelection="true" 
                                                            completeMethod="#{subAccountSummaryReportMB.completeAdminUnit}" >


                                            </p:autoComplete>
                                        </h:panelGroup>
                                    </h:panelGroup>
                                </div>
                                <div class="ui-g-12 ui-md-6">
                                    <h:panelGroup>

                                        <h:panelGroup>
                                            <p:outputLabel style="width: 65px;margin-bottom: 5%" value="#{userData.userDDs['FINANCE_YEAR']}"/>
                                        </h:panelGroup>
                                        <h:panelGroup>
                                            <p:selectOneMenu style="width:57%;margin-right: 1%" id="year" filter="true" filterMatchMode="startsWith" 
                                                             value="#{subAccountSummaryReportMB.glYearSelection}" converter="#{subAccountSummaryReportMB.glYearConverter}"  >
                                                <p:ajax update="dateFrom dateTo" listener="#{subAccountSummaryReportMB.pushGlYearSelection()}" />
                                                <f:selectItems value="#{subAccountSummaryReportMB.glYearList}"  var="year" itemLabel="#{year.name}" itemValue="#{year}"/>
                                            </p:selectOneMenu>
                                        </h:panelGroup>

                                    </h:panelGroup>
                                </div>
                                <div class="ui-g-12 ui-md-6">
                                    <h:panelGroup>
                                        <h:panelGroup>
                                            <p:outputLabel style="width: 65px"
                                                           value="#{userData.userDDs['CURRENCY']}"/>
                                        </h:panelGroup>
                                        <h:panelGroup>
                                            <p:selectOneMenu style="width:57%;margin-right: 1%" id="paymentType"  value="#{subAccountSummaryReportMB.subAccountSummarySearchBean.currencyType}"  >                                                             
                                                <f:selectItem itemLabel="#{userData.userDDs['LOCAL_CURRENCY']}"  itemValue="0"  />
                                                <f:selectItem itemLabel="#{userData.userDDs['FOREIGN_CURRENCY']}"  itemValue="1"  />
                                            </p:selectOneMenu>                  
                                        </h:panelGroup>

                                    </h:panelGroup>
                                </div>
                                <div class="ui-g-12 ui-md-6">
                                    <h:panelGroup>
                                        <h:panelGroup>
                                            <p:outputLabel  style="width: 65px" value="#{userData.userDDs['YEAR_FROM']}"/>
                                        </h:panelGroup>
                                        <h:panelGroup>
                                            <p:calendar id="dateFrom" 
                                                        value="#{subAccountSummaryReportMB.subAccountSummarySearchBean.dateFrom}" 
                                                        pattern="dd/MM/yyyy" 
                                                        style="width:57%" 
                                                        showButtonPanel="true"
                                                        >
                                            </p:calendar>
                                        </h:panelGroup>
                                    </h:panelGroup>
                                </div>
                                <div class="ui-g-12 ui-md-6">
                                    <h:panelGroup>
                                        <h:panelGroup>
                                            <p:outputLabel  style="width: 65px;margin-right: .5%" 
                                                            value="#{userData.userDDs['YEAR_TO']}"/>
                                        </h:panelGroup>
                                        <h:panelGroup>
                                            <p:calendar  style="width:57%"
                                                         id="dateTo" 
                                                         value="#{subAccountSummaryReportMB.subAccountSummarySearchBean.dateTo}" 

                                                         pattern="dd/MM/yyyy">
                                            </p:calendar>
                                            <h:outputText value="">
                                                <f:convertDateTime pattern="MM/dd/yyyy" />
                                            </h:outputText>
                                        </h:panelGroup>      
                                    </h:panelGroup>
                                </div>
                            </div>
                        </div>
                    </div>


                </p:fieldset>
                
                <p:fieldset style=" margin: 10px 0">
                    <h:panelGrid class="col-md-12 centerButtons" columns="1" style="margin-top:2%"> 

                        <h:panelGroup class="centerButtons"> 


                            <p:commandButton class="searchButton"  
                                             icon="fa fa-fw fa-search-plus"
                                             id="searchS"
                                             value="#{userData.userDDs['SEARCH']}"
                                             action="#{subAccountSummaryReportMB.search()}" 
                                             update="subaccc" />

                            <p:commandButton class="newButton"   icon="fa fa-fw fa-plus"
                                             id="newN"
                                             value="#{userData.userDDs['NEW']}" 
                                             action="#{subAccountSummaryReportMB.reset}"
                                             update="subaccc" />
                            <p:commandButton   class="printButton"  icon="fa fa-fw fa-print"
                                               ajax="false" 
                                               onclick="form.target = '_blank'" 
                                               value="#{userData.userDDs['PRINT']}"
                                               actionListener="#{subAccountSummaryReportMB.exportPDF}"/>
                            <h:commandLink class="sdcreenimg">  
                                <p:graphicImage name="/img/excel.jpg" width="24"/>  
                                <p:dataExporter type="xls"
                                                target="subaccc" 
                                                fileName="كشف حساب فرعى"
                                                postProcessor="#{subAccountSummaryReportMB.postProcessXLS}" />  
                            </h:commandLink>

                            <p:blockUI block="TopFielSet" trigger="searchS  newN" animate="true" >

                                <p:graphicImage library="img" name="9wcA.gif" ></p:graphicImage>

                            </p:blockUI> 


                        </h:panelGroup>

                    </h:panelGrid>
                    
                </p:fieldset>
                
                <p:fieldset legend="" style="margin-bottom:20px">


                    <p:dataTable 
                        draggableColumns="true" 
                        widgetVar="sub" 
                        id="subaccc"                   
                        var="subaccReport" 
                        dir="#{userData.dir}" 
                        rowKey="#{subaccReport}" 
                        value="#{subAccountSummaryReportMB.subAccountSummaryReports}" 
                        rows="20"
                        paginator="true" 
                        emptyMessage="#{userData.userDDs['EMPTY_TABLE']}" >
                        <f:facet name="header" class="col-md-12">

                            <p:outputPanel>
                                <h:outputText value="#{userData.userDDs['SEARCH']} : "  style="font-size: large;" />
                                <p:inputText   id="globalFilter"   onkeyup="PF('sub').filter()" style="width: 50%important" />
                            </p:outputPanel>
                        </f:facet>
                        <p:column style="width:10vh ;text-align: -webkit-auto;font-size:1.8vh"
                                  filterBy="#{subaccReport.date}"  filterMatchMode="contains" sortBy="#{subaccReport.date}" filterable="false"
                                  headerText="#{userData.userDDs['DATEE']}">
                            <h:outputText value="#{subaccReport.date}" style="font-size: 1.2vh">
                                <f:convertDateTime id="datee"  pattern="dd-MM-yyyy" />
                            </h:outputText>
                        </p:column>

                        <p:column style="width:10vh ;text-align: -webkit-auto;font-size:1.8vh"  
                                  headerText="#{userData.userDDs['GENERAL_NUMBER']}"
                                  filterBy="#{subaccReport.serial}"  filterMatchMode="contains" sortBy="#{subaccReport.serial}" filterable="false">
                            <h:outputText value="#{subaccReport.serial}" style="font-size: 12px"/>
                        </p:column>

                        <p:column style="width:10vh ;text-align: -webkit-auto;font-size:1.8vh"  
                                  headerText="#{userData.userDDs['DOCUMENT_NUMBER']}"
                                  filterBy="#{subaccReport.generalDecument}"  filterMatchMode="contains" sortBy="#{subaccReport.generalDecument}" filterable="false">
                            <h:outputText value="#{subaccReport.generalDecument}" style="font-size: 12px"/>
                        </p:column>

                        <p:column style="width:15vh ;text-align: -webkit-auto;font-size:1.8vh"
                                  headerText="#{userData.userDDs['JOURNAL_TYPE']}"
                                  filterBy="#{subaccReport.symbolName}"  filterMatchMode="contains" sortBy="#{subaccReport.symbolName}" filterable="false">
                            <h:outputText value="#{subaccReport.symbolName}" style="font-size: 12px"/>
                        </p:column>

                        <p:column style="width:20vh ;text-align: -webkit-auto;font-size:1.8vh" headerText="#{userData.userDDs['GERNAL_STATEMENT']}">
                            <h:outputText value="#{subaccReport.generalStatement}" style="font-size: 12px"/>
                        </p:column>

                        <p:column style="width:10vh ;text-align: -webkit-auto;font-size:1.8vh" headerText="#{userData.userDDs['DEBIT']}">
                            <p:inputNumber readonly="true" value="#{subaccReport.debitAmount}" style="font-size: 12px ; width: 95%"/>
                        </p:column>

                        <p:column style="width:10vh ;text-align: -webkit-auto;font-size:1.8vh"  headerText="#{userData.userDDs['CREDIT']}">
                            <p:inputNumber readonly="true" value="#{subaccReport.creditAmount}" style="font-size: 12px; width: 95%"/>
                        </p:column>

                        <p:column style="width:10vh ;text-align: -webkit-auto;font-size:1.8vh" headerText="#{userData.userDDs['BALANCE']}">
                            <p:inputNumber readonly="true" value="#{subaccReport.balance}" style="font-size: 12px; width: 95%"/>
                        </p:column>
                        <p:columnGroup type="footer">
                            <p:row>
                                <p:column colspan="5"  footerText="#{userData.userDDs['TOTAL']}" /> 
                                <p:column  footerText="#{subAccountSummaryReportMB.totalDebitString}" /> 
                                <p:column  footerText="#{subAccountSummaryReportMB.totalCreditString}" /> 
                                <p:column  footerText="" /> 
                            </p:row>

                        </p:columnGroup>
                    </p:dataTable>

                </p:fieldset>
            </h:form>
        </h:body>
    </ui:define>
</ui:composition>

